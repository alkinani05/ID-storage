(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,83086,e=>{"use strict";let t=(0,e.i(75254).default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["Sparkles",()=>t],83086)},78583,e=>{"use strict";let t=(0,e.i(75254).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);e.s(["FileText",()=>t],78583)},98919,e=>{"use strict";let t=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);e.s(["Shield",()=>t],98919)},40160,e=>{"use strict";let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],40160)},3116,86536,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>a],3116);let l=(0,t.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>l],86536)},33174,e=>{"use strict";var t=e.i(43476),a=e.i(71645),l=e.i(18566),s=e.i(54858),r=e.i(46932),d=e.i(40160),i=e.i(78583),n=e.i(31278),o=e.i(98919),c=e.i(83086),x=e.i(75254);let p=(0,x.default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var h=e.i(3116),m=e.i(86536);let u=(0,x.default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function w(){let e,x,w,b,g,y=(0,l.useParams)(),f=y?.token,[j,N]=(0,a.useState)(null),[v,k]=(0,a.useState)(null),[M,T]=(0,a.useState)(!0),[D,S]=(0,a.useState)(""),[U,C]=(0,a.useState)(!1);(0,a.useEffect)(()=>{f&&(async()=>{try{let e=await s.default.get(`/share/${f}`);N(e.data.document),k(e.data.permissions)}catch(e){S(e.response?.data?.message||"هذا الرابط غير صالح أو انتهت صلاحيته.")}finally{T(!1)}})()},[f]);let $=async()=>{if(!v?.allowDownload)return void alert("التحميل غير مسموح لهذا الرابط");if(v.oneTimeDownload&&v.downloadUsed)return void alert("تم استخدام التحميل مسبقاً");C(!0);try{let e=await s.default.get(`/share/${f}/download`,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),a=window.document.createElement("a");a.href=t,a.setAttribute("download",j?.originalName||j?.title||"document"),window.document.body.appendChild(a),a.click(),a.remove(),v.oneTimeDownload&&k({...v,downloadUsed:!0})}catch(e){alert(e.response?.data?.message||"فشل التحميل")}C(!1)};return M?(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center text-white",children:(0,t.jsx)(n.Loader2,{className:"h-10 w-10 animate-spin text-purple-500"})}):D?(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center text-white p-4",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.Shield,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,t.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"تعذر الوصول للمستند"}),(0,t.jsx)("p",{className:"text-slate-400",children:D})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center p-4 bg-[url('/grid.svg')] bg-fixed print:bg-white",dir:"rtl",children:(0,t.jsxs)(r.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-3xl w-full bg-slate-900/80 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl print:bg-white print:text-black print:shadow-none",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-purple-500/30 print:hidden",children:(0,t.jsx)(i.FileText,{className:"h-8 w-8 text-white"})}),(0,t.jsx)("h1",{className:"text-3xl font-black mb-2 print:text-black",children:j.title}),(0,t.jsx)("p",{className:"text-slate-400 print:text-gray-600",children:"تمت مشاركة هذا المستند معك عبر وثقني"})]}),v&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center mb-6 print:hidden",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1.5 bg-slate-800/50 rounded-full text-xs",children:[(0,t.jsx)(h.Clock,{className:"h-3 w-3 text-blue-400"}),(0,t.jsxs)("span",{children:["ينتهي خلال: ",(e=new Date(v.expiresAt),x=new Date,b=Math.floor((w=e.getTime()-x.getTime())/36e5),g=Math.floor(w%36e5/6e4),b>24?`${Math.floor(b/24)} يوم`:b>0?`${b} ساعة`:g>0?`${g} دقيقة`:"منتهي")]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1.5 bg-slate-800/50 rounded-full text-xs",children:[(0,t.jsx)(m.Eye,{className:"h-3 w-3 text-purple-400"}),(0,t.jsxs)("span",{children:["المشاهدات: ",v.viewsCount,v.maxViews?`/${v.maxViews}`:""]})]}),v.oneTimeDownload&&!v.downloadUsed&&(0,t.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1.5 bg-orange-500/20 rounded-full text-xs text-orange-400",children:[(0,t.jsx)(u,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"تحميل مرة واحدة"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[(0,t.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-2xl border border-white/5 print:border-gray-300",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1 print:text-gray-500",children:"النوع"}),(0,t.jsx)("p",{className:"font-bold text-lg print:text-black",children:j.category})]}),(0,t.jsxs)("div",{className:"bg-slate-800/50 p-4 rounded-2xl border border-white/5 print:border-gray-300",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1 print:text-gray-500",children:"الحجم"}),(0,t.jsxs)("p",{className:"font-bold text-lg print:text-black",children:[(j.size/1024).toFixed(1)," KB"]})]})]}),j.mimeType?.startsWith("image")&&(0,t.jsx)("div",{className:"mb-8 rounded-2xl overflow-hidden border border-white/10",children:(0,t.jsx)("img",{src:`${s.API_URL}/share/${f}/download`,alt:j.title,className:"w-full h-auto",onError:e=>{e.target.style.display="none"}})}),j.extractedData?.length>0&&(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-600/10 to-purple-600/10 border border-purple-500/20 rounded-2xl p-6 mb-8 print:bg-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)(c.Sparkles,{className:"h-5 w-5 text-purple-400 print:text-purple-600"}),(0,t.jsx)("span",{className:"font-bold text-purple-200 print:text-purple-800",children:"البيانات المستخرجة"})]}),(0,t.jsx)("p",{className:"text-slate-300 leading-relaxed print:text-gray-700",children:j.extractedData[0].fieldValue})]}),(0,t.jsxs)("div",{className:"flex gap-3 print:hidden",children:[v?.allowPrint&&(0,t.jsxs)("button",{onClick:()=>{v?.allowPrint?window.print():alert("الطباعة غير مسموحة لهذا الرابط")},className:"flex-1 bg-purple-600/20 border border-purple-500/30 py-4 rounded-2xl font-bold text-lg hover:bg-purple-600/30 transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)(p,{className:"h-6 w-6 text-purple-400"}),(0,t.jsx)("span",{className:"text-purple-300",children:"طباعة"})]}),v?.allowDownload&&(0,t.jsx)("button",{onClick:$,disabled:U||v.oneTimeDownload&&v.downloadUsed,className:`flex-1 py-4 rounded-2xl font-bold text-lg shadow-lg flex items-center justify-center gap-2 transition-all ${v.oneTimeDownload&&v.downloadUsed?"bg-slate-700 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-600 to-purple-600 shadow-purple-500/20 hover:scale-[1.02]"}`,children:U?(0,t.jsx)(n.Loader2,{className:"h-6 w-6 animate-spin"}):v.oneTimeDownload&&v.downloadUsed?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Shield,{className:"h-6 w-6"}),"تم استخدام التحميل"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.Download,{className:"h-6 w-6"}),"تحميل المستند"]})})]}),!v?.allowDownload&&!v?.allowPrint&&(0,t.jsxs)("div",{className:"text-center py-4 text-slate-400 text-sm",children:[(0,t.jsx)(o.Shield,{className:"h-6 w-6 mx-auto mb-2 text-slate-500"}),"هذا الرابط للعرض فقط"]})]})})}e.s(["default",()=>w],33174)}]);